
<!doctype html>
<html lang="en">




<head>
    <title>How to Build Peek IOS Field App - Attune Automation</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="title"
          content="How to Build Peek IOS Field App - Attune Automation">
    <meta name="description"
          content="">
    <meta name="robots"
          content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large">

    <meta property="og:locale" content="en_AU" />
    <meta property="og:type" content="article" />
    <meta property="og:title"
          content="HowTo Build Peek IOS Field App - Attune Automation" />
    <meta property="og:description" content="" />
    <meta property="og:site_name" content="Attune Automation" />
    <meta property="article:section" content="IT Instruction" />

    <meta name="twitter:title"
          content="How to Build Peek IOS Field App - Attune Automation" />
    <meta name="twitter:description" content="" />

    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-32x32.png" sizes="32x32">
    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-192x192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-180x180.png">
    <meta name="msapplication-TileImage" content="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-270x270.png">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="styles/style.css">

    <!-- Google tag (gtag.js) -->
    <script async
            src="https://www.googletagmanager.com/gtag/js?id=G-5TZQZNDJCD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-5TZQZNDJCD');
    </script>
</head>


<body>

<!-- Project NavBar -->

<div class="bg-white border-bottom box-shadow sticky-top mb-3">
<div class="container px-0">
    <div class="row px-0">
        <div class="col d-flex flex-column flex-lg-row align-items-center px-0
            py-3">
            <a class="navbar-brand my-0 mr-lg-auto"
                  href="https://www.servertribe.com/"
                  target="_blank">
                    <img
                        src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                        alt="Attune - Powered by ServerTribe"
                        class="img-fluid navbar-img">
            </a>
            <nav class="my-2 my-lg-0 mr-lg-3">
                <a class="p-2 text-dark" href="http://doc.servertribe.com/"
                   target="_blank">
                    Documentation
                </a>
                <a class="p-2 text-dark"
                   href="https://discord.com/invite/3YpJsagqUn"
                   target="_blank">
                    Discord
                </a>
                <a class="p-2 text-dark" href="https://github.com/Attune-Automation"
                   target="_blank">
                    GitHub
                </a>
                <a class="p-2 text-dark" href="https://www.servertribe.com/learn/"
                   target="_blank">
                    Learn
                </a>
            </nav>
            <a class="btn btn-outline-primary"
               href="https://www.servertribe.com/download-attune-registration/"
               target="_blank">
                Download NOW!
            </a>
        </div>
    </div>
</div></div>

<!-- Project breadcrumbs -->

<!-- Project breadcrumbs -->
<div class="container px-0">
    <div class="row">
        <nav class="col px-0" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="index.html">
                    Peek Build Field App
                    </a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                    <strong>Build Peek IOS Field App</strong>
                </li>
            </ol>
        </nav>
    </div>
</div>

<!-- Blueprint Header -->

<div class="container px-0">
    <!-- Blueprint name and description -->
    <div class="row">
        <div class="col px-0">
            <h1 class="text-left">
                How to Build Peek IOS Field App
            </h1>
        </div>
    </div>

<!-- Blueprint Description -->
    <div class="row pt-4">
        <div class="col-6 px-0">
            <h6 class="text-left">
                This documentation is generated by
                <a href="https://www.servertribe.com/"
                    class="badge badge-primary"
                    target="_blank">
                    Attune
                </a>
            </h6>
        </div>
        <div class="col-6 align-self-end text-right px-0">
            <h6 class="text-right">
                <a href="https://www.youtube.com/@servertribe"
                    class="badge badge-secondary"
                    target="_blank">
                    YouTube
                </a>
                <a href="https://github.com/Attune-Automation"
                    class="badge badge-secondary"
                    target="_blank">
                    GitHub
                </a>
                <a href="https://discord.com/invite/3YpJsagqUn"
                    class="badge badge-secondary"
                    target="_blank">
                    Discord
                </a>
                <a href="https://www.linkedin.com/company/servertribe/"
                    class="badge badge-secondary"
                    target="_blank">
                    LinkedIn
                </a>
                <a href="http://doc.servertribe.com/"
                    class="badge badge-secondary"
                    target="_blank">
                    Documentation
                </a>
            </h6>
        </div>
    </div>
    <hr>
</div>

<div class="documentation">
    <div class="container px-0">
        <div class="row">

<!-- Blueprint ToC -->


            <div class="toc col-lg-2 px-0 pr-5">
                <div class="container px-0 pt-3">
                    <p class="pb-2">
                        <strong>Contents</strong>
                    </p>
                    <p class="text-muted">
                        <a href="#top">
                            <strong>Build Peek IOS Field App</strong>
                        </a>
                    </p>


    
        

                    <p class="text-muted pt-2">
                        <a href="#cleanbuilddirectory">
                            <strong>Step 1 -</strong> Clean Build Directory
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#pullappfrompeekhost">
                            <strong>Step 2 -</strong> Pull App from Peek Host
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#pullfieldappfrompeekserver">
                            <strong>Step 2.1 -</strong> Pull field app from peek server
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#movepeekfieldappintoplace">
                            <strong>Step 2.2 -</strong> Move peek_field_app into place
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#personaliseapp">
                            <strong>Step 3 -</strong> Personalise App
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#appupdateappbackgroundcolour">
                            <strong>Step 3.1 -</strong> App Update App Background Colour
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#appupdatedisplayname">
                            <strong>Step 3.2 -</strong> App Update Display Name
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#appupdateconfigscreenversion">
                            <strong>Step 3.3 -</strong> App Update Config Screen Version
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#apphardcodeconnectionsettings">
                            <strong>Step 3.4 -</strong> App Hardcode  Connection Settings
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#preparecapacitor">
                            <strong>Step 4 -</strong> Prepare Capacitor
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#runnpminstall">
                            <strong>Step 4.1 -</strong> Run NPM Install
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#runngbuild">
                            <strong>Step 4.2 -</strong> Run NG Build
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#runcapsync">
                            <strong>Step 4.3 -</strong> Run Cap Sync
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#patchnativeaudioplugin">
                            <strong>Step 4.4 -</strong> Patch native-audio plugin
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#patchpodspeekframeworkssh">
                            <strong>Step 4.5 -</strong> Patch Pods-peek-frameworks.sh
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#runcapcopyios">
                            <strong>Step 4.6 -</strong> Run Cap Copy iOS
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#appdeployicons">
                            <strong>Step 4.7 -</strong> App Deploy Icons
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#appupdateicon">
                            <strong>Step 4.8 -</strong> App Update Icon
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#runcapupdateicons">
                            <strong>Step 4.9 -</strong> Run Cap Update Icons
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#preparexcodeapp">
                            <strong>Step 5 -</strong> Prepare XCode App
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#xcodewritesettings">
                            <strong>Step 5.1 -</strong> XCode Write Settings
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodesettargetversion">
                            <strong>Step 5.2 -</strong> XCode Set Target Version
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcoderenameapp">
                            <strong>Step 5.3 -</strong> XCode Rename App
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodesetdeploymenttarget">
                            <strong>Step 5.4 -</strong> XCode Set Deployment Target
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodepodinstall">
                            <strong>Step 5.5 -</strong> XCode Pod Install
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodeshowsdks">
                            <strong>Step 5.6 -</strong> XCode Show SDKs
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodeshowprojectbuildoptions">
                            <strong>Step 5.7 -</strong> XCode Show Project Build Options
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#xcodecapopen">
                            <strong>Step 6 -</strong> XCode Cap Open
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#archiveiosapp">
                            <strong>Step 7 -</strong> Archive iOS App
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#xcodecleanandanalyze">
                            <strong>Step 7.1 -</strong> XCode Clean and Analyze
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodearchiveapp">
                            <strong>Step 7.2 -</strong> XCode Archive App
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodeinspectarchiveplist">
                            <strong>Step 7.3 -</strong> XCode Inspect Archive PList
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodeinspectarchiveprovisioningprofile">
                            <strong>Step 7.4 -</strong> XCode Inspect Archive Provisioning Profile
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodeinspectcodesignature">
                            <strong>Step 7.5 -</strong> XCode Inspect Code Signature
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#buildxcodeipa">
                            <strong>Step 8 -</strong> Build XCode IPA
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#xcodepopulateplistforipa">
                            <strong>Step 8.1 -</strong> XCode Populate PList for IPA
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#xcodebuildappipa">
                            <strong>Step 8.2 -</strong> XCode Build App IPA
                        </a>
                    </p>



                </div>
            </div>

<!-- Blueprint Contents -->
            <div class="col-lg-8 pt-3">
                <div class="container">


        <div class="jumbotron">
            <p class="display-3 text-center">
                <strong>Automate This</strong>
            </p>
            <p class="lead text-center">
                Use the <strong>Attune GUI</strong> for your Scripts
            </p>
            <p class="lead">
                <ol>
                    <a href="https://www.servertribe.com/download-attune-registration/"
                        target="_blank">
                        <span class="badge badge-primary">1</span>
                        Download Attune
                        <i class="fa-solid fa-download fa-beat-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://github.com/attune-Automation/"
                        target="_blank">
                        <span class="badge badge-primary">2</span>
                         Copy the Attune Project URL
                         <i class="fa-brands fa-github fa-fade"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://servertribe-attune.readthedocs.io/en/latest/howto/design_workspace/clone_project.html"
                        target="_blank">
                        <span class="badge badge-primary">3</span>
                        Clone the Project in Attune
                         <i class="fa-solid fa-book fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=GCWDI29rDV0"
                        target="_blank">
                        <span class="badge badge-primary">4</span>
                        Plan your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=b7DhFcURkZg"
                        target="_blank">
                        <span class="badge badge-primary">5</span>
                        Run your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
            </p>
            <p class="lead text-center">
                You've automated: <strong>Build Peek IOS Field App</strong>
            </p>
            <hr class="my-4 text-center">
            <div class="col px-0">
                <p class="text-center">
                    Get the most out of automation with our get started
                    videos, product demonstrations, and more.
                </p>
                <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://www.servertribe.com/learn/"
                       target="_blank"
                       role="button">
                        Learn Attune Automation
                    </a>
                </p>
            </div>
        </div>

        <div class="row">
            <p>The following steps will guide you through the manual process.</p>
        </div>

<!-- Blueprint Steps -->


        



                    <div class="row pt-5">
                        <h3 id="cleanbuilddirectory">
                            <a href="#cleanbuilddirectory">
                                <strong>Step 1 -</strong> Clean Build Directory
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {macosuser}@{macoshost}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;

if [ -d &quot;$DIR&quot; ]
then
    echo &quot;Removing build directory&quot;
    rm -rf &quot;$DIR&quot;
else
    echo &quot;Directory doesn&#x27;t exist, good.&quot;
fi

mkdir -p &quot;$DIR&quot;
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="pullappfrompeekhost">
                            <a href="#pullappfrompeekhost">
                                <strong>Step 2 -</strong> Pull App from Peek Host
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="pullfieldappfrompeekserver">
                            <a href="#pullfieldappfrompeekserver">
                                <strong>Step 2.1 -</strong> Pull field app from peek server
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

echo &quot;Creating remote TAR&quot;
ssh \
    -o StrictHostKeyChecking=no \
    -o UserKnownHostsFile=/dev/null \
    -o PreferredAuthentications=password \
    {peekFieldAppSourceLinuxUser.user}@{peekFieldAppSourceNode.ip} &lt;&lt;&#x27;EOF&#x27;
    NEWEST_DIR=&quot;$(ls -1trd synerty-peek*  | tail -1)&quot;
    if [ -z &quot;${NEWEST_DIR}&quot; ]
    then
        echo &quot;ERROR: We can&#x27;t find the synerty-peek* directory&quot;
        false
    else
        tar cjf peek_field_app.tar.bz2 \
            --exclude node_modules \
            -C ${NEWEST_DIR}/lib/python*/site-packages/ \
            peek_field_app
    fi
EOF

echo &quot;Copying remote tar&quot;
scp \
    -o StrictHostKeyChecking=no \
    -o UserKnownHostsFile=/dev/null \
    -o PreferredAuthentications=password \
    {peekFieldAppSourceLinuxUser.user}@{peekFieldAppSourceNode.ip}:peek_field_app.tar.bz2 \
    .

echo &quot;Removing remote TAR&quot;
ssh \
    -o StrictHostKeyChecking=no \
    -o UserKnownHostsFile=/dev/null \
    -o PreferredAuthentications=password \
    {peekFieldAppSourceLinuxUser.user}@{peekFieldAppSourceNode.ip} &lt;&lt;EOF
    rm peek_field_app.tar.bz2
EOF


echo &quot;Extracting TAR&quot;
tar xjf peek_field_app.tar.bz2

echo &quot;Removing TAR&quot;
rm -v peek_field_app.tar.bz2
                </code>
            </pre>
        </div>
    </div>

    <div class="row">
        <p>
            This script may require you to answer the following prompts:
        </p>
    </div>
    <div class="row">
        <table>
            <thead>
                <tr>
                    <th>
                        Prompt
                    </th>
                    <th class="prompts">
                        Answer
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        password:
                    </td>
                    <td class="prompts">
                        <code class="language-sql">
{peekFieldAppSourceLinuxUser.password}
                        </code>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>




    



                    <div class="row pt-5">
                        <h4 id="movepeekfieldappintoplace">
                            <a href="#movepeekfieldappintoplace">
                                <strong>Step 2.2 -</strong> Move peek_field_app into place
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

mv -v peek_field_app/* .
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="personaliseapp">
                            <a href="#personaliseapp">
                                <strong>Step 3 -</strong> Personalise App
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="appupdateappbackgroundcolour">
                            <a href="#appupdateappbackgroundcolour">
                                <strong>Step 3.1 -</strong> App Update App Background Colour
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;
echo $PATH

SCSS=&quot;src/_variables.scss&quot;

if [ &#x27;{appEnvironment}&#x27; = &#x27;DEV&#x27; ]
then
    echo &quot;Updating to DEV Orange&quot;
    sed -i &#x27;s/$primary-color:.*/$primary-color: #ff9900;/g&#x27; $SCSS
    
elif  [ &#x27;{appEnvironment}&#x27; = &#x27;SIT&#x27; ]
then
    echo &quot;Updating to SIT Green&quot;
    sed -i &#x27;s/$primary-color:.*/$primary-color: #75f497;/g&#x27; $SCSS

elif  [ &#x27;{appEnvironment}&#x27; = &#x27;UAT&#x27; ]
then
    echo &quot;Updating to UAT Puple&quot;
    sed -i &#x27;s/$primary-color:.*/$primary-color: #800080;/g&#x27; $SCSS


elif  [ &#x27;{appEnvironment}&#x27; = &#x27;DEMO&#x27; ]
then
    echo &quot;Demonstration stays as is.&quot;


elif  [ &#x27;{appEnvironment}&#x27; = &#x27;PRD&#x27; ]
then
    echo &quot;Production stays as is.&quot;
    
else
    echo &quot;Unknown environment |{appEnvironment}|&quot; &gt;&amp;2
    false
fi

grep &#x27;$primary-color:&#x27; $SCSS
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="appupdatedisplayname">
                            <a href="#appupdatedisplayname">
                                <strong>Step 3.2 -</strong> App Update Display Name
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

JSON=&quot;capacitor.config.json&quot;

cat $JSON \
    | jq &#x27;.appName = &quot;{appDisplayName}&quot;&#x27; \
    | jq &#x27;.appId = &quot;{appId}&quot;&#x27; \
    | tee $JSON
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="appupdateconfigscreenversion">
                            <a href="#appupdateconfigscreenversion">
                                <strong>Step 3.3 -</strong> App Update Config Screen Version
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

CONFIG_TS=&quot;src/app/pages/config/config.page.ts&quot;

sed -iv &#x27;s/Peek Config/{appEnvironment} Peek Config/g&#x27; \
    &quot;${CONFIG_TS}&quot;
    
grep &quot;Peek Config&quot; &quot;${CONFIG_TS}&quot;


CONFIG_HTML=&quot;src/app/pages/config/config.page.html&quot;

sed -iv &#x27;s/Peek Field App/Peek {appEnvironment} Field App/g&#x27; \
    &quot;${CONFIG_HTML}&quot;
    
grep &quot;Field App&quot; &quot;${CONFIG_HTML}&quot;


VERSION_TS=&quot;src/environments/peek-app-environment.ts&quot;


sed -iv &#x27;s/version:.*/version: &quot;v{appDotVersion} b{appBuildVersion}&quot;,/g&#x27; \
    &quot;${VERSION_TS}&quot;

grep version &quot;${VERSION_TS}&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="apphardcodeconnectionsettings">
                            <a href="#apphardcodeconnectionsettings">
                                <strong>Step 3.4 -</strong> App Hardcode  Connection Settings
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

cat &lt;&lt;EOF | tee src/@peek/peek_core_device/_private/tuples/server-info-tuple-defaults.ts
export const SERVER_INFO_TUPLE_DEFAULTS = {
    host: &#x27;{appPeekHardcodedHost}&#x27;,
    useSsl: {appPeekHardcodedHostUseSsl},
    httpPort: {appPeekHardcodedHostPort},
    websocketPort: {appPeekHardcodedHostPort},
    hasConnected: true // Required to be true to override stored settings
};
EOF
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="preparecapacitor">
                            <a href="#preparecapacitor">
                                <strong>Step 4 -</strong> Prepare Capacitor
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="runnpminstall">
                            <a href="#runnpminstall">
                                <strong>Step 4.1 -</strong> Run NPM Install
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

# HACK
npm install --save &quot;angular-svg-icon@10.0.0+b31479&quot;

npm install
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="runngbuild">
                            <a href="#runngbuild">
                                <strong>Step 4.2 -</strong> Run NG Build
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

if {ngBuildForProduction}
then
    echo Building Angular - Peek field app for production
    ng build --prod --optimization  --common-chunk --vendor-chunk
else
    echo Building Angular - Peek field app for dev
    ng build
fi
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="runcapsync">
                            <a href="#runcapsync">
                                <strong>Step 4.3 -</strong> Run Cap Sync
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;
echo &quot;We&#x27;re at $(pwd)&quot;

echo Syncing capacitor build
export LANG=en_US.UTF-8
npx cap sync
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="patchnativeaudioplugin">
                            <a href="#patchnativeaudioplugin">
                                <strong>Step 4.4 -</strong> Patch native-audio plugin
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

echo Patching native-audio plugin

#  https://github.com/danielsogl/awesome-cordova-plugins/issues/2685#issuecomment-567261609
sed -i &#x27;s/@&quot;www&quot;/@&quot;public&quot;/&#x27; \
    ios/capacitor-cordova-ios-plugins/sources/CordovaPluginNativeaudio/NativeAudio.m
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="patchpodspeekframeworkssh">
                            <a href="#patchpodspeekframeworkssh">
                                <strong>Step 4.5 -</strong> Patch Pods-peek-frameworks.sh
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

echo Patching native-audio plugin

# Pathching pod script
sed -i &#x27;s/source=&quot;$(readlink &quot;${source}&quot;)&quot;/source=&quot;$(readlink -f &quot;${source}&quot;)&quot;/g&#x27; \
        ios/App/Pods/Target\ Support\ Files/Pods-peek/Pods-peek-frameworks.sh
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="runcapcopyios">
                            <a href="#runcapcopyios">
                                <strong>Step 4.6 -</strong> Run Cap Copy iOS
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

echo Applying patch
npx cap copy ios
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="appdeployicons">
                            <a href="#appdeployicons">
                                <strong>Step 4.7 -</strong> App Deploy Icons
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            
        </p>
        <p>
            Copy the File(s)
            <strong>Peek_Icons.tar</strong>
            to the target node.
        </p>
        <p>
            <strong>Extract and deploy the File(s)</strong> here:
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
{appBuildDirectory}/{appId}/staged_icons, relative to the home directory
        </code>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="appupdateicon">
                            <a href="#appupdateicon">
                                <strong>Step 4.8 -</strong> App Update Icon
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd &quot;{appBuildDirectory}/{appId}&quot;

mkdir -vp resources

cp -v staged_icons/{appEnvironment}.png resources/icon.png
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="runcapupdateicons">
                            <a href="#runcapupdateicons">
                                <strong>Step 4.9 -</strong> Run Cap Update Icons
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{appBuildDirectory}/{appId}&quot;
cd &quot;$DIR&quot;

# one-off install image asset automation tool
npm install -g cordova-res


# generate image assets for xcode project
# cordova-res ios --skip-config --copy

# For just the icon, run
cordova-res ios --skip-config --copy --type icon
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="preparexcodeapp">
                            <a href="#preparexcodeapp">
                                <strong>Step 5 -</strong> Prepare XCode App
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="xcodewritesettings">
                            <a href="#xcodewritesettings">
                                <strong>Step 5.1 -</strong> XCode Write Settings
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
echo &quot;Writing settings for app&quot;

cd &quot;{appBuildDirectory}/{appId}&quot;

echo &quot;export NOW=$(date -u +%Y%m%d_%H%M%SUTC)&quot; &gt; attune_xcode_settings.sh

cat &lt;&lt;&#x27;EOF&#x27; &gt;&gt; attune_xcode_settings.sh
export APP_DIR=&quot;{appBuildDirectory}/{appId}&quot;
export XCODE_SOURCE_FOLDER=&quot;${APP_DIR}/ios/App&quot;

export XCODE_PROFILE_DIR=&quot;${HOME}/Library/MobileDevice/Provisioning Profiles&quot;

# parameter defaults

# public version on App Store page
export XCODE_APP_VERSION=&#x27;{appDotVersion}&#x27;

# CI job number, internal version for technical purposes
export XCODE_BUILD_VERSION=&#x27;{appBuildVersion}&#x27;

# app bundle identifier
export XCODE_APP_BUNDLE_IDENTIFIER=&#x27;{appId}&#x27;

# Apple Developer Team ID
export XCODE_DEVELOPEMENT_TEAM_ID=&#x27;{xcodeTeam}&#x27;

# UUID of mobile provisioning profile
export XCODE_PROVISIONING_PROFILE_NAME=&quot;{xcodeProvisioningProfileName}&quot;
EOF

source attune_xcode_settings.sh
pushd &quot;${XCODE_PROFILE_DIR}&quot;
XCODE_PROVISIONING_PROFILE_UUID=&quot;$(grep -l &#x27;{xcodeProvisioningProfileName}&#x27; * | sed &#x27;s/.mobileprovision//g&#x27;)&quot;
popd

echo &quot;export XCODE_PROVISIONING_PROFILE_UUID=${XCODE_PROVISIONING_PROFILE_UUID}&quot; \
     &gt;&gt; attune_xcode_settings.sh


cat &lt;&lt;&#x27;EOF&#x27; &gt;&gt; attune_xcode_settings.sh

# script default
export XCODE_APP_NAME=&#x27;{appDisplayName}&#x27;


# override defaults by arguments

# automatic populated parameters for xcode
# relative to source folder above
export XCODE_WORKSPACE=&quot;$XCODE_APP_NAME.xcworkspace&quot;
export XCODE_BUILD_CONFIGURATION=&#x27;Release&#x27;
export XCODE_SCHEME=$XCODE_APP_NAME
export XCODE_CACHED_PROVISIONING_PROFILE_PATH=&quot;${XCODE_PROFILE_DIR}/${XCODE_PROVISIONING_PROFILE_UUID}.mobileprovision&quot;

export XCODE_ARCHIVE_PATH=&quot;{appExportDirectory}/peek_${XCODE_BUILD_VERSION}_${XCODE_APP_VERSION}_${NOW}&quot;
export XCODE_IPA_EXPORT_PATH=&quot;{appExportDirectory}/ipa_peek_${XCODE_BUILD_VERSION}_${XCODE_APP_VERSION}_${NOW}&quot;


export XCODE_BUILT_ARCHIVE_FOLDER=&quot;${XCODE_ARCHIVE_PATH}.xcarchive&quot;

EOF
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodesettargetversion">
                            <a href="#xcodesettargetversion">
                                <strong>Step 5.2 -</strong> XCode Set Target Version
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_SOURCE_FOLDER

xcrun agvtool new-version -all {appBuildVersion}

xcrun agvtool new-marketing-version {appDotVersion}


sed -iv &#x27;s/MARKETING_VERSION = .*/MARKETING_VERSION = {appDotVersion};/g&#x27; \
    *xcodeproj/project.pbxproj
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcoderenameapp">
                            <a href="#xcoderenameapp">
                                <strong>Step 5.3 -</strong> XCode Rename App
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
echo &quot;This is disabled, rename by hand.&quot;
# cd &quot;{appBuildDirectory}/{appId}&quot;

# cd ios/app

# sed -i &#x27;s/\tname = .*/\tname = &quot;{appDisplayName}&quot;;/g&#x27; \
#     App.xcodeproj/project.pbxproj

# sed -i &#x27;s/BuildableName = .*/BuildableName = &quot;{appDisplayName}.app&quot;/g&#x27; \
#     App.xcodeproj/xcshareddata/xcschemes/App.xcscheme

# sed -i &#x27;s/BlueprintName = .*/BlueprintName = &quot;{appDisplayName}&quot;/g&#x27; \
#     App.xcodeproj/xcshareddata/xcschemes/App.xcscheme
    
# grep &quot;{appDisplayName}&quot; \
#     App.xcodeproj/xcshareddata/xcschemes/App.xcscheme \
#     App.xcodeproj/project.pbxproj
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodesetdeploymenttarget">
                            <a href="#xcodesetdeploymenttarget">
                                <strong>Step 5.4 -</strong> XCode Set Deployment Target
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_SOURCE_FOLDER

xcrun agvtool new-version -all {appBuildVersion}

xcrun agvtool new-marketing-version {appDotVersion}


sed -iv &#x27;s/IPHONEOS_DEPLOYMENT_TARGET = .*/IPHONEOS_DEPLOYMENT_TARGET = 15.0;/g&#x27; \
    *xcodeproj/project.pbxproj
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodepodinstall">
                            <a href="#xcodepodinstall">
                                <strong>Step 5.5 -</strong> XCode Pod Install
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Follow the Sudo-less installation here</p>
<p>https://guides.cocoapods.org/using/getting-started.html#getting-started</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd &quot;{appBuildDirectory}/{appId}&quot;

cd ios/App
set -x

echo &quot;pod should be installed under the users home directory&quot;
echo &quot;Ideally ~/opt/cocoapods/bin/pod&quot;
echo .
echo &quot;If it&#x27;s not, follow&quot;
echo &quot;Follow the Sudo-less installation here&quot;
echo &quot;https://guides.cocoapods.org/using/getting-started.html#getting-started&quot;
which pod
echo .

# Assert it exists
echo &quot;Checking for Podfile&quot;
echo .
ls -l Podfile
echo .

echo &quot;Running pod install&quot;
echo &quot;.&quot;

export LANG=en_US.UTF-8
pod install
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodeshowsdks">
                            <a href="#xcodeshowsdks">
                                <strong>Step 5.6 -</strong> XCode Show SDKs
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_SOURCE_FOLDER

xcodebuild -showsdks
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodeshowprojectbuildoptions">
                            <a href="#xcodeshowprojectbuildoptions">
                                <strong>Step 5.7 -</strong> XCode Show Project Build Options
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_SOURCE_FOLDER

xcodebuild -list
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="xcodecapopen">
                            <a href="#xcodecapopen">
                                <strong>Step 6 -</strong> XCode Cap Open
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
hostname

cd &quot;{appBuildDirectory}/{appId}&quot;

npx cap open ios
false
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="archiveiosapp">
                            <a href="#archiveiosapp">
                                <strong>Step 7 -</strong> Archive iOS App
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="xcodecleanandanalyze">
                            <a href="#xcodecleanandanalyze">
                                <strong>Step 7.1 -</strong> XCode Clean and Analyze
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_SOURCE_FOLDER

echo &quot;xcodebuild clean analyze&quot;

export LANG=en_US.UTF-8

xcodebuild clean analyze \
    -quiet \
    -workspace $XCODE_WORKSPACE \
    -scheme $XCODE_SCHEME \
    -verbose
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodearchiveapp">
                            <a href="#xcodearchiveapp">
                                <strong>Step 7.2 -</strong> XCode Archive App
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_SOURCE_FOLDER

echo &quot;xcodebuild archive&quot;

export LANG=en_US.UTF-8

if {xcodeAutoCodeSignStyle}
then
    echo CODE_SIGN_STYLE=&quot;Auto&quot;
    xcodebuild archive \
        -quiet \
        -workspace $XCODE_WORKSPACE \
        -scheme $XCODE_SCHEME \
        -configuration $XCODE_BUILD_CONFIGURATION \
        -archivePath $XCODE_ARCHIVE_PATH \
        -allowProvisioningUpdates \
        CODE_SIGN_STYLE=&quot;Auto&quot; \
        PRODUCT_BUNDLE_IDENTIFIER_APP=&quot;${XCODE_APP_BUNDLE_IDENTIFIER}&quot; \
        DEVELOPEMENT_TEAM=&quot;${XCODE_DEVELOPEMENT_TEAM_ID}&quot; \
        CFBundleShortVersionString=&quot;${XCODE_APP_VERSION}&quot; \
        CFBundleVersion=&quot;${XCODE_BUILD_VERSION}&quot;

else
    echo CODE_SIGN_STYLE=&quot;Manual&quot;
    xcodebuild archive \
        -quiet \
        -workspace $XCODE_WORKSPACE \
        -scheme $XCODE_SCHEME \
        -configuration $XCODE_BUILD_CONFIGURATION \
        -archivePath $XCODE_ARCHIVE_PATH \
        -allowProvisioningUpdates \
        CODE_SIGN_STYLE=&quot;Manual&quot; \
        PROVISIONING_PROFILE_SPECIFIER=&quot;${XCODE_PROVISIONING_PROFILE_UUID}&quot; \
        PRODUCT_BUNDLE_IDENTIFIER_APP=&quot;${XCODE_APP_BUNDLE_IDENTIFIER}&quot; \
        DEVELOPEMENT_TEAM=&quot;${XCODE_DEVELOPEMENT_TEAM_ID}&quot; \
        CFBundleShortVersionString=&quot;${XCODE_APP_VERSION}&quot; \
        CFBundleVersion=&quot;${XCODE_BUILD_VERSION}&quot;
fi
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodeinspectarchiveplist">
                            <a href="#xcodeinspectarchiveplist">
                                <strong>Step 7.3 -</strong> XCode Inspect Archive PList
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_BUILT_ARCHIVE_FOLDER

infoPlist=&quot;Products/Applications/${XCODE_APP_NAME}.app/Info.plist&quot;
echo &quot;== inspect archive: marked versions in $infoPlist ==&quot;

echo &quot;--Info.plist starts--&quot;
echo
for key in CFBundleShortVersionString CFBundleVersion
do
    output=$(/usr/libexec/PlistBuddy -c &#x27;Print :&#x27;&quot;${key}&quot; &quot;$infoPlist&quot;)
    echo $key&quot;: &quot;$output

    if [[ $VERIFY_SIGN -eq 1 ]]
    then
        case $key in
        &quot;CFBundleShortVersionString&quot;)
            # app version on app store - public
            if [[ -z &quot;${output##*$XCODE_APP_VERSION*}&quot; ]]
            then
                echo &quot;APP Version - pass&quot;
            else
                echo &quot;APP Version - fail&quot;
                exit 1
            fi
            ;;
        &quot;CFBundleVersion&quot;)
            # build version - technical
            if [[ -z &quot;${output##*$XCODE_BUILD_VERSION*}&quot; ]]
            then
                echo &quot;Build Version - pass&quot;
            else
                echo &quot;Build Version - fail&quot;
                exit 1
            fi
            ;;
        esac
    fi
    echo
done
echo &quot;--Info.plist ends--&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodeinspectarchiveprovisioningprofile">
                            <a href="#xcodeinspectarchiveprovisioningprofile">
                                <strong>Step 7.4 -</strong> XCode Inspect Archive Provisioning Profile
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_BUILT_ARCHIVE_FOLDER

profileInArchive=&quot;Products/Applications/${XCODE_APP_NAME}.app/embedded.mobileprovision&quot;
echo &quot;== inspect archive: mobileprovision file in $profileInArchive ==&quot;

echo &quot;--mobile provisioning profile starts--&quot;
echo
for key in TeamName TeamIdentifier ExpirationDate Name
do
    output=$(/usr/libexec/PlistBuddy \
       -c &#x27;Print &#x27;&quot;${key}&quot; /dev/stdin &lt;&lt;&lt; $(security cms -D -i $profileInArchive))

    echo $key&quot;: &quot;$output
    if [[ $VERIFY_SIGN -eq 1 ]]
    then
        case $key in
        &quot;TeamIdentifier&quot;)
            # substring match
            if [[ -z &quot;${output##*$XCODE_DEVELOPEMENT_TEAM_ID*}&quot; ]]
            then
                echo &quot;Team ID verify - pass&quot;
            else
                echo &quot;Team ID verify - fail&quot;
                exit 1
            fi
            ;;
        &quot;ExpirationDate&quot;)
            _expire=$(date -jf &#x27;%a %b %e %H:%M:%S %Z %Y&#x27; &quot;${output}&quot; &#x27;+%s&#x27;)
            _now=$(date &#x27;+%s&#x27;)
            if [[ $_expire -ge $_now ]]
            then
                echo &quot;Expiration date - pass&quot;
            else
                echo &quot;Expiration date - fail&quot;
                exit 1
            fi
            ;;
        &quot;Name&quot;)
            if [[ -z &quot;${output##*$XCODE_PROVISIONING_PROFILE_UUID*}&quot; ]]
             then
                echo &quot;Mobileprovision Name - pass&quot;
            else
                echo &quot;Mobileprovision Name - fail&quot;
                exit 1
            fi
            ;;
        esac
    fi
    echo
done
unset file
echo &quot;--mobile provisioning profile ends--&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodeinspectcodesignature">
                            <a href="#xcodeinspectcodesignature">
                                <strong>Step 7.5 -</strong> XCode Inspect Code Signature
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_BUILT_ARCHIVE_FOLDER

appFolder=Products/Applications/*.app
echo &quot;== inspect archive: code signature ==&quot;
        
pushd $appFolder

    codesign -d --extract-certificates .


    echo
    echo &quot;--trust chain starts--&quot;
    echo
    for certFile in codesign*
    do
        openssl x509 -inform DER -in $certFile -noout \
            -subject -issuer -dates
        echo
    done
    echo &quot;--trust chain ends--&quot;
    echo

    echo clean up extracted signatures for inspections
    rm -f codesign*

popd
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="buildxcodeipa">
                            <a href="#buildxcodeipa">
                                <strong>Step 8 -</strong> Build XCode IPA
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="xcodepopulateplistforipa">
                            <a href="#xcodepopulateplistforipa">
                                <strong>Step 8.1 -</strong> XCode Populate PList for IPA
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_SOURCE_FOLDER

PLIST=&quot;${XCODE_ARCHIVE_PATH}.xcarchive/exportOptionsPlist.plist&quot;
cp &quot;../../scripts/exportOptionsPlist.plist.template&quot; \
    &quot;${PLIST}&quot;
    
PLIST=$1

echo &#x27;populating exportOptionsPlist.plist &#x27;&quot;${PLIST}&quot;
# delete bundle id and profile name from template
/usr/libexec/PlistBuddy \
    -c &#x27;Delete :provisioningProfiles&#x27; &quot;${PLIST}&quot;

# update bundle id
echo &quot;new ipa bundle id: ${XCODE_APP_BUNDLE_IDENTIFIER}&quot;
echo &quot;new ipa provisioning profile name: ${XCODE_PROVISIONING_PROFILE_UUID}&quot;
/usr/libexec/PlistBuddy -c \
&quot;Add :provisioningProfiles:${XCODE_APP_BUNDLE_IDENTIFIER} string ${XCODE_PROVISIONING_PROFILE_UUID}&quot; \
    &quot;${PLIST}&quot;

# replace team id
echo &quot;new ipa team id: $XCODE_DEVELOPEMENT_TEAM_ID&quot;
/usr/libexec/PlistBuddy -c \
    &quot;Set :teamID $XCODE_DEVELOPEMENT_TEAM_ID&quot; PLIST
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="xcodebuildappipa">
                            <a href="#xcodebuildappipa">
                                <strong>Step 8.2 -</strong> XCode Build App IPA
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
source &quot;{appBuildDirectory}/{appId}/attune_xcode_settings.sh&quot;
cd $XCODE_SOURCE_FOLDER

exportOptionsPlistPath=&quot;${XCODE_ARCHIVE_PATH}.xcarchive/exportOptionsPlist.plist&quot;

xcodebuild -exportArchive \
    -quiet \
    -archivePath $XCODE_ARCHIVE_PATH&quot;.xcarchive&quot; \
    -exportPath $XCODE_IPA_EXPORT_PATH \
    -exportOptionsPlist &quot;${exportOptionsPlistPath}&quot; \
    PROVISIONING_PROFILE_SPECIFIER=&quot;${XCODE_PROVISIONING_PROFILE_UUID}&quot; \
    PRODUCT_BUNDLE_IDENTIFIER_APP=&quot;${XCODE_APP_BUNDLE_IDENTIFIER}&quot; \
    DEVELOPEMENT_TEAM=&quot;${XCODE_DEVELOPEMENT_TEAM_ID}&quot; \
    CFBundleShortVersionString=&quot;${XCODE_APP_VERSION}&quot; \
    CFBundleVersion=&quot;${XCODE_BUILD_VERSION}&quot;
                </code>
            </pre>
        </div>
    </div>







                    <div class="row pt-5">
                        <div class="col">
                            <h2>Completed</h2>
                            <p>
                                You have completed this instruction.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

<!-- Download Attune Ad -->

            <div class="toc col-lg-2 px-0">
                <div class="container px-0 pt-3 pl-5">
                    <div class="card border-light mb-3" style="max-width: 18rem;">
                        <div class="card-body attune-ad">
                            <img
                                src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                                alt="Attune - Powered by ServerTribe"
                                class="img-fluid">
                            <p class="card-title mt-3 text-center">
                                <strong>Automate with Attune</strong>
                            </p>
                            <p class="card-text text-center">
                                Download the Attune Community Edition.
                            </p>
                            <p class="text-center">
                                <a href="https://www.servertribe.com/download-attune-registration/"
                                   class="btn btn-primary mt-3">
                                    DOWNLOAD!!!
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

<!-- Join Discord -->

        <div class="row py-5">
            <div class="jumbotron">
              <h1 class="display-4 text-center">
                  Discuss this Project in Discord
              </h1>
              <p class="lead">

                  Join our Discord channel and connect with like-minded individuals who
                  share your passion. Engage in lively discussions, gain valuable insights,
                  and stay updated on the latest trends in our industry. Don't miss out on
                  this opportunity to network, learn, and grow together.
              </p>
              <hr class="my-4 text-center">
                <div class="col px-0">
                  <p class="text-center">
                      Click the link below and become a part of our vibrant community on
                      Discord today!
                  </p>
                  <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://discord.com/invite/3YpJsagqUn"
                       role="button">
                        Join NOW!!!
                    </a>
                  </p>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Project Footer -->

<footer class="footer fixed-bottom bg-white border-top box-shadow">
      <div class="container px-0">
          <div class="row">
              <div class="col px-0">
                  <a class="my-0 mr-lg-auto"
                     href="https://www.servertribe.com/"
                     target="_blank">
                      <img
                          src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                          alt="Attune - Powered by ServerTribe"
                          class="img-fluid navbar-img">
                  </a>
              </div>
          </div>
      </div>
</footer>


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>


</body>
</html>
